
# Chapter 2. 넘파이로 공부하는 선형대수

## 2.1 데이터와 행렬

### 데이터의 유형

선형 대수에서 다루는 데이터의 종류

- 스칼라 : 숫자 하나로 이루어진 데이터
- 벡터 : 여러 숫자로 이루어진 데이터 레코드
- 행렬 : 벡터, 즉 데이터 레고크다 여럿인 데이터 집합
- 텐서 : 같은 크기의 행렬이 여러개 있는 것


## 2.2 벡터와 행렬의 연산

### 벡터/행렬의 덧셈과 뺄셈 

=> 요소별 연산

### 스칼라와 벡터/행렬의 곱셈

벡터 $x$ 또는 행렬 $A$의 모든 원소에 스칼라 값 $c$를 곱하는 것

### 브로드캐스팅

원래 덧셈과 뺄셈은 크기(차원)가 같은 두 벡터에 대해서만 할 수 있다. 하지만 벡터와 스칼라의 경우에는 관례적으로 다음처럼 1-벡터를 사용하여 스칼라를 벡터로 변환하는 연산을 허용한다. 이를 **브로드캐스팅**이라고 한다.

$$
\begin{bmatrix}
10 \\
11 \\
12
\end{bmatrix}
- 10 = \begin{bmatrix}
10 \\
11 \\
12
\end{bmatrix}
- 10 \cdot 1 = \begin{bmatrix}
10 \\
11 \\
12
\end{bmatrix} - \begin{bmatrix}
10 \\
10 \\
10
\end{bmatrix}
$$

데이터 분석에서는 원래의 데이터 벡터 $x$가 아니라 그 데이터 벡터의 각 원소의 평균값을 뺀 **평균 제거 벡터** 또는 **0-평균 벡터**를 사용하는 경우가 많다.


### 선형 조합

벡터/행렬에 다음처럼 스칼라 값을 곱한 후 더하거나 뺀 것을 벡터/행렬의 **선형조합**(linear combination)이라고 한다. 벡터나 행렬을 선형조합해도 크기는 변하지 않는다.

### 벡터와 벡터의 곱셈

벡터를 곱셈하는 방법은 여러가지가 있지만 여기서는 **내적**(linear product)에 대해서만 다룬다. 벡터 $x$와 벡터 $y$의 내적은 아래와 같이 표기한다.

$$ x^Ty $$

내적은 다음처럼 점(dot)으로 표기하는 경우도 있어서 **닷 프로덕트**(dot product)라고도 부르고 $< x, y >$ 기호로 나타낼 수도 있다.

두 벡터를 내적하기 위한 조건은 아래와 같다.

- 우선 두 벡터의 차원(길이)이 같아야 한다.
- 앞의 벡터가 행벡터이고 뒤의 벡터가 열벡터여야 한다.

이때 내적의 결과는 **스칼라 값이 된다.** 아래는 두 벡터 내적의 예시이다.

$$ x = \begin{bmatrix}
1 \\
2 \\
3
\end{bmatrix}, y = \begin{bmatrix}
4 \\
5 \\
6
\end{bmatrix}
$$

$$ x^Ty = \begin{bmatrix}1 & 2 & 3\end{bmatrix} \begin{bmatrix}4 \\ 5 \\ 6\end{bmatrix} =
1 \cdot 4 + 2 \cdot 5 + 3 \cdot 6 = 32
$$

넘파이에서 벡터와 행렬의 내적은 `dot()`이라는 명령 또는 `@`(at이라고 읽는다) 연산자로 계산한다. 2차원 배열로 표시한 벡터를 내적했을 때는 결과값이 스칼라가 아닌 2차원 배열이다.

```python
x = np.array([[1], [2], [3]])
y = np.array([[4], [5], [6]])

np.dot(x.T, y)
```

### 가중합